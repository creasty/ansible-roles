- name: install god
  command: bash -lc 'gem install god --no-ri --no-rdoc'

- name: create directory
  command: mkdir -p /etc/god/config /etc/god/contacts

- name: copy config.god
  template:
    src:  '{{ common_path }}/templates/god/config.god'
    dest: /etc/god/config.god

- name: copy contact methods file
  template:
    src:  '{{ common_path }}/templates/god/{{ item }}.rb'
    dest: '/etc/god/contacts/{{ item }}.rb'
  with_items:
    - email
    - twilio

- name: copy delayed_job.god
  template:
    src:  '{{ common_path }}/templates/god/delayed_job.god'
    dest: /etc/god/config/delayed_job.god

- name: start god
  command:       god -c /etc/god/config.god
  ignore_errors: true

