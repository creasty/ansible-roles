- name: node | activate nvm
  lineinfile:
    dest:   '{{ item }}/.bashrc'
    regexp: 'nvm/nvm\.sh'
    line:   'source /usr/local/nvm/nvm.sh'
    state:  present
  with_items:
    - '{{ user.path }}'
    - '~'

- name: node | copy nvm initialize script
  copy:
    src:   '{{ common_path }}/files/nodejs/nvm.sh'
    dest:  /etc/profile.d/nvm.sh
    owner: root
    group: root
    mode:  0755

- name: node | install node
  command: 'nvm install {{ nodejs.version }}'

- name: node | declare node version
  command: 'nvm use {{ nodejs.version }}'
