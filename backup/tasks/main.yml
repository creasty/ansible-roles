- name: install backup gem
  command: bash -lc 'gem install backup --no-ri --no-rdoc'

- name: create directory
  file:
    path:    /root/Backup/models
    recurse: yes
    state:   directory

- name: copy config.rb
  template:
    src:  config.rb
    dest: /root/Backup/config.rb

- name: copy database_backup.rb
  template:
    src:  database_backup.rb
    dest: /root/Backup/models/database_backup.rb

- name: register cron job
  cron:
    name:   'Backup at 4am every day'
    hour:   '4'
    minute: '0'
    job:    '/bin/bash -lc "backup perform -t database_backup"'

